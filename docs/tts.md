# ğŸ”Š ä½¿ç”¨ç¬¬ä¸‰æ–¹ TTS

`MiGPT` é»˜è®¤ä½¿ç”¨å°ç±³è‡ªå¸¦çš„ TTS æœ—è¯»æ–‡å­—å†…å®¹ï¼Œå¦‚æœä½ éœ€è¦ï¼š

1. ç»•è¿‡å°ç±³ TTS æç¤ºæ–‡å­—å­˜åœ¨æ•æ„Ÿä¿¡æ¯
2. ä½¿ç”¨ç¬¬ä¸‰æ–¹ TTS æˆ–æœ¬åœ°æ­å»ºçš„ TTS æœåŠ¡ï¼Œè‡ªå®šä¹‰ TTS éŸ³è‰²

ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ­¥éª¤ï¼Œåˆ‡æ¢ `MiGPT` ä½¿ç”¨çš„ TTS å¼•æ“ï¼š

1. é…ç½® `TTS_BASE_URL` ç¯å¢ƒå˜é‡
2. åˆ‡æ¢ `speaker.tts` ä¸º `custom`

```js
// .env
TTS_BASE_URL=http://[ä½ çš„å±€åŸŸç½‘æˆ–å…¬ç½‘åœ°å€]:[ç«¯å£å·]/apiï¼Œæ¯”å¦‚ï¼šhttp://192.168.31.205:4321/api

// .migpt.js
export default {
  speaker: {
    // TTS å¼•æ“
    tts: 'custom',
    // åˆ‡æ¢ TTS å¼•æ“å‘è¨€äººéŸ³è‰²å…³é”®è¯
    switchSpeakerKeywords: ["æŠŠå£°éŸ³æ¢æˆ"], // ä»¥æ­¤å…³é”®è¯å¼€å¤´å³å¯åˆ‡æ¢éŸ³è‰²ï¼Œæ¯”å¦‚ï¼šæŠŠå£°éŸ³æ¢æˆ xxx
    // ...
  },
};
```

é…ç½®æˆåŠŸåï¼Œå³å¯é€šè¿‡ `å°çˆ±åŒå­¦ï¼ŒæŠŠå£°éŸ³æ¢æˆ xxx` è¯­éŸ³æŒ‡ä»¤åˆ‡æ¢ TTS éŸ³è‰²ã€‚

[MiGPT-TTS](https://github.com/idootop/mi-gpt-tts) æ”¯æŒçš„å®Œæ•´ TTS éŸ³è‰²åˆ—è¡¨ä¸åç§°è¯·æŸ¥çœ‹æ­¤å¤„ï¼š[volcano.ts](https://github.com/idootop/mi-gpt-tts/blob/main/src/tts/volcano.ts)

## TTS_BASE_URL

å…¶ä¸­ `TTS_BASE_URL` æ˜¯ä½ çš„å¤–éƒ¨ TTS æœåŠ¡å¼•æ“åœ°å€ã€‚è¿™é‡Œæä¾›ä¸€ä¸ª Node.js ç«¯çš„ç¤ºä¾‹ï¼š[MiGPT-TTS](https://github.com/idootop/mi-gpt-tts)ï¼š

ç›®å‰æ¥å…¥äº† [ç«å±±å¼•æ“](https://www.volcengine.com/docs/6561/79817) çš„è¯­éŸ³åˆæˆæœåŠ¡ï¼Œå®åè®¤è¯åå¯ä»¥å…è´¹ä½¿ç”¨ 21 æ¬¾å¸¸ç”¨éŸ³è‰²ã€‚

å…·ä½“éƒ¨ç½²å’Œä½¿ç”¨æ•™ç¨‹ï¼Œè¯·ç§»æ­¥ï¼šhttps://github.com/idootop/mi-gpt-tts

## æ”¯æŒæ›´å¤šçš„ TTS æœåŠ¡

å¦‚æœä½ æƒ³ä½¿ç”¨æœ¬åœ° TTS æœåŠ¡ï¼ˆæ¯”å¦‚ï¼šChatTTSï¼‰ï¼Œæˆ–è€…æ¥å…¥å…¶ä»– TTS æœåŠ¡å•†ï¼ˆæ¯”å¦‚å¾®è½¯ã€è®¯é£ã€OpenAI ç­‰ï¼‰ï¼Œ

å¯å‚è€ƒä¸Šé¢çš„ [MiGPT-TTS](https://github.com/idootop/mi-gpt-tts) é¡¹ç›®ä»£ç è‡ªè¡Œæ­å»ºæœåŠ¡ç«¯ï¼Œåªéœ€æ»¡è¶³ä»¥ä¸‹æ¥å£å³å¯ï¼š

### GET `/api/tts.mp3`

æ–‡å­—åˆæˆéŸ³é¢‘ï¼Œè¯·æ±‚ç¤ºä¾‹ï¼š`/api/tts.mp3?speaker=BV700_streaming&text=å¾ˆé«˜å…´è®¤è¯†ä½ `

å…¶ä¸­ï¼Œè¯·æ±‚å‚æ•° `speaker` ä¸ºæŒ‡å®šéŸ³è‰²åç§°æˆ–æ ‡è¯†ï¼Œå¯é€‰ã€‚

> æ³¨æ„ï¼šå°çˆ±éŸ³ç®±åœ¨è®¿é—®éŸ³é¢‘é“¾æ¥æ—¶ï¼Œå¯èƒ½ä¼šå°†è¯·æ±‚é“¾æ¥ä¸­çš„ `&text=` è½¬ä¹‰æˆ `+text=`ï¼Œä½ éœ€è¦åœ¨ Server ç«¯æ‰‹åŠ¨ä¿®å¤è¯·æ±‚å‚æ•°ã€‚ç›¸å…³ [issue](https://github.com/idootop/mi-gpt/issues/120)

### GET `/api/speakers`

è·å–éŸ³è‰²åˆ—è¡¨

| å±æ€§    | è¯´æ˜     | ç¤ºä¾‹              |
| ------- | -------- | ----------------- |
| name    | éŸ³è‰²åç§° | `ç¿ç¿`            |
| gender  | æ€§åˆ«     | `å¥³`              |
| speaker | éŸ³è‰²æ ‡è¯† | `BV700_streaming` |

è¿”å›å€¼ç¤ºä¾‹

```json
[
  {
    "name": "å¹¿è¥¿è€è¡¨",
    "gender": "ç”·",
    "speaker": "BV213_streaming"
  },
  {
    "name": "ç”œç¾å°å¦¹",
    "gender": "å¥³",
    "speaker": "BV025_streaming"
  }
]
```

## å¯ç”¨çš„ TTS å¼•æ“åˆ—è¡¨

å¦‚æœä½ å®ç°äº†å¯¹æ›´å¤š TTS æœåŠ¡çš„æ”¯æŒï¼Œæ¬¢è¿æäº¤ PRï¼Œå°†ä½ çš„é¡¹ç›®åˆ†äº«ç»™å¤§å®¶ã€‚

- [MiGPT-TTS](https://github.com/idootop/mi-gpt-tts)ï¼šç›®å‰æ¥å…¥äº† [ç«å±±å¼•æ“](https://www.volcengine.com/docs/6561/79817) çš„è¯­éŸ³åˆæˆæœåŠ¡ï¼Œå®åè®¤è¯åå¯ä»¥å…è´¹ä½¿ç”¨ 21 æ¬¾å¸¸ç”¨éŸ³è‰²ã€‚
